<html>

<body>
	<script>

		let day19inputTest = `     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ `;
		let day19input = `                                                                                                                                                   |                                                     
                         +-+             +-----------------------------+   +---+                                                           +-------+   +-+ +-+                   +-+     +-------+   +-+ 
                         | |             |                             |   |   |                                                           |           | | | |                   | |     |       |   | | 
           +-------------+ |   +-+     +-------------------------------|---|---|---------------------------------------------------------+ |           | | | |                   | |     |     +-+   | | 
           |               |   | |     | |                             |   |   |                                                         | |           | | | |                   | |     |     |     | | 
           |               |   | |     | |                 +-+   +---+ |   |   |         +-------------------------------------------------|-------------+ | |                   | |     |     |     | | 
           |               |   | |     | |                 | |   |   | |   |   |         |                                               | |           |   | |                   | |     |     |     | | 
   +-------|-------------------|-|-+   | |             +---+ I +-|---|-|---+   |         |                   +-------------------------------------------------------------------|-|-----|---+ +-------+ 
   |       |               |   | | |   | |             |       | |   | |       |         |                   |                           | |           |   | |                   | |     |   |       |   
   |       |               |   +---------|-------------|---------+ +-|---------|---------|-----------+       |                           | |     +---------|-|-------------------------------|-----+ |   
   |       |               |     | |   | |             |       |   | | |       |         |           |       |                           | |     |     |   | |                   | |     |   |     | |   
   |       |               |     | | +---|-------------|-------|---|-|-------------+     |           |       |                     +-------|-+   |     |   | +---------------------|-----|---+     | |   
   |       |               |     | | | | |             |       |   | | |       |   |     |           |       |                     |     | | |   |     |   |                     | |     |         | |   
   |       |               |     | | | | |             |       |   | | |   +---|---------|-----------|-------|---------------------|-------|-----------|-------------------------|-------|-------+ | |   
   |       |               |     | | | | |             |       |   | | |   |   |   |     |           |       |                     |     | | |   |     |   |                     | |     |       | | |   
   |       |               |     | | | | |             | +-----|---|-------|-------|-----|-----------------------------------------|---------|-------+ |   +---------------------|-|-------------|---+   
   |       |               |     | | | | |             | |     |   | | |   |   |   |     |           |       |                     |     | | |   |   | |                         | |     |       | |     
   |       |               |     | +-|-|---------------|-|-----|-----|-|---+   |   |     |           |       |                     |     | | |   |   | |       +-------------+   +-------|---+   | |     
   |       |               |     |   | | |             | |     |   | | |       |   |     |           |       |                     |     | | |   |   | |       |             |     |     |   |   | |     
 +---------------------+ +-------|-----|---------------|-|-----|-----|-|-----------+     |           |       |           +-----------------|-----|-----|---------------------------|-----|-----+ | |     
 | |       |           | | |     |   | | |             | |     |   | | |       |         |           |       |           |         |     | | |   |   | |       |             |     |     |   | | | |     
 | |       |           | | |     |   | | |             | |     | +-|---|-------|---------------------|-------------------|---------|-----|-------|---|-|-------|-----------------------+ |   | | | |     
 | |       |           | | |     |   | | |             | |     | | | | |       |         |           |       |           |         |     | | |   |   | |       |             |     |   | |   | | | |     
 | |       |           | | |     |   | | |         +-----|---+ +-------|-----------------|-----------|-------+           |         | +---|-------------|---------------------|---------|-|-----+ | |     
 | |       |           | | |     |   | | |         |   | |   |   | | | |       |         |           |                   |         | |   | | |   |   | |       |             |     |   | |   |   | |     
 | | +-+ +-|-----------|-------------|-|-|---------------------+ | | +-|-----------------|-----------|---+     +---------|---------------|-|-|-----------------|-------------|-----|-----|---|---------+ 
 | | | | | |           | | |     |   | | |         |   | |   | | | |   |       |         |           |   |     |         |         | |   | | |   |   | |       |             |     |   | |   |   | |   | 
 | | | | | |           | | |     |   | | |         | +-|-|-+ | | | |   |       |         |           |   | +---|-----+   |         | |   | | |   |   | |       |       +-----|-----|-----|---+   | |   | 
 | | | | | |           | | |     |   | | |         | | | | | | | | |   |       |         |           |   | |   |     |   |         | |   | | |   |   | |       |       |     |     |   | |       | |   | 
 | | | | | +---+       | | |     |   | | |         +-|---|---|-|-----+ |   +-------------|-----------|---+ |   |     |   |         | |   | | |   |   | |       | +-----------------------|-+     | |   | 
 | | | | |     |       | | |     |   | | |           | | | | | | | | | |   |   |         |           |     |   |     |   |         | |   | | |   |   | |       | |     |     |     |   | | |     | |   | 
 | | | | |     |       | | |     |   | | |           | | | | | | | | | |   |   |         |   +---------------------------------------|---|---|---|---------------------|-------------------+     | |   | 
 | | | | |     |       | | |     |   | | |           | | | | | | | | | |   |   |         |   |       |     |   |     |   |         | |   | | |   |   | |       | |     |     |     |   | |       | |   | 
 | | | | |     |       | | |     |   | | |           | | | | | | | | | |   |   |         |   |       +-----|-+ |   +-----|-----------|---|-|-|-------------+ +---|-+   |     |     | +-----+     | |   | 
 | | | | |     |       | | |     |   | | |           | | | | | | | | | |   |   |         |   |             | | |   | |   |         | |   | | |   |   | |   | | | | |   |     |     | | | | |     | |   | 
 | | | | |     |       | | |     |   | | |           | | +-|-|-|---+ | |   |   |         |   |             | | |   | +-------------|-----------------|-|---|-|-|---|---------------|-|-|-|-----+ | |   | 
 | | | | |     |       | | |     |   | | |           | |   | | | |   | |   |   |         |   |             | | |   |     |         | |   | | |   |   | |   | | | | |   |     |     | | | | |   | | |   | 
 | | | | |     +---------|-|-----|-+ | | |           | |   | | | |   +-------------------|----------------------C--|---------------+ |   | | |   |   | |   | | +-------|-----|-----+ | | | |   | | |   | 
 | | | | |             | | |     | | | | |           | |   | | | |     |   |   |         |   |             | | |   |     |           |   | | |   |   | |   | |   | |   |     |       | | | |   | | |   | 
 | | | +-----------------|-------|-|---|-|-----------|-----|-|-|-|-----|-----------------|---|---------------------|-----|-----------|-------|-------|-----------|-----------|-----+ | | | | +-|-+ |   | 
 | | |   |             | | |     | | | | |           | |   | | | |     |   |   |         |   |             | | |   |     |           |   | | |   |   | |   | |   | |   |     |     | | | | | | |   |   | 
 | | |   |             | | |     | | | | |           | |   | | | |     |   |   |         |   |             | | |   |     |           |   | | |   |   | |   | |   | |   |     |     | +-|---|-+ |   |   | 
 | | |   |             | | |     | | | | |           | |   | | | |     |   |   |         |   |             | | |   |     |           |   | | |   |   | |   | |   | |   |     |     |   | | |   |   |   | 
 | | |   |             | | |     | | | +---------------------|---|---------|---------+   |   |             | | +---+     |           |   | | |   |   | |   | |   +-|-----------------+ | | | +-------+ | 
 | | |   |             | | |     | | |   |           | |   | | | |     |   |   |     |   |   |             | |           |           |   | | |   |   | |   | |     |   |     |     | | | | | | |   | | | 
 | | |   |             | | |     | | |   |           | |   | | | |     |   |   |     |   |   |             | |           |           |   | | |   |   | |   | |   +-|---------|-----|-|---+ | | |   | | | 
 | | |   |             | | |     | | |   |           | |   | | | |     |   |   |     |   |   |             | |           |           |   | | |   |   | |   | |   | |   |     |     | | |   | | |   | | | 
 | | |   |             | | |     | | |   |           | |   | | | | +---|---|-+ |     |   | +---+           | |           |           |   | | |   +-----|-----|---|-|-----------------|-----|---+   | | | 
 | | |   |             | | |     | | |   |           | |   | | | | |   |   | | |     |   | | | |           | |           |           |   | | |       | |   | |   | |   |     |     | | |   | |     | | | 
 | | |   |             | | |     | | |   |           +-|---|-------+   |   | | |     |   | | | |           | |           |           |   | | |       | |   | |   | |   |     |   +-|-|---------+   | | | 
 | | |   |             | | |     | | |   |             |   | | | |     |   | | |     |   | | | |           | |           |           |   | | |       | |   | |   | |   |     |   | | | |   | | |   | | | 
 | | |   |           +-|-----+   | | |   |             |   | | | |     |   | | |     |   | | | |           | |           |           |   | | |       | |   | +---|-|---|-----|---|-|-+ |   | | |   | | | 
 | | |   |           | | | | |   | | |   |             |   | | | |     |   | | |     |   | | | |           | |           |           |   | | |       | |   |     | |   |     |   | |   |   | | |   | | | 
 | | |   |           | | | | |   | | |   |     +-----+ +---------|---+ |   | | |     |   | | | |           | |           |           |   | | |       | |   |   +-|---+ |   +-----|---+ |   | | |   | | | 
 | | |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |           |   | | |       | |   |   | | | | |   | |   | | | |   | | |   | | | 
 | | |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |           |   | | |       | |   |   | | | | |   | |   | | | |   | | +-+ | | | 
 | | |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |           |   | | |       | |   |   | | | | |   | |   | | | |   | |   | | | | 
 +-+ |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |           |   | | |       | +---------|-|---------------------------+ | | | | 
     |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |           |   | | |       |     |   | | | | |   | |   | | | |   | | | | | | | 
     |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |     +-----------|-----------------------|---------------|-|-----|-----|-|-|-+ 
     |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |     |     |   | | |       |     |   | | | | |   | |   | | | |   | | | | | |   
     |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |     |     |   | | |       |     |   | | | | |   | |   | | | | +-|---|-|-+ |   
     |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |     |     |   | | |       |     |   | | | | |   | |   | | | | | | | | |   |   
     |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |     +-----|-------------|-----|-----|-----|---------|---------|-|-|-|-------|-----|-+ | | | | | |   |   
     |   |           | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |     |     | |           |     |     |   | | |       |     |   | | | | |   | |   | |   | | | | | |   |   
     |   |         +-------|-----|---|---|-----|-----|-----------|---|-|---|-|-|-----|-----|---------------|-|-----------|-----|-----|-----|---------|-----|-----|-|-|-----|-|-----|---|-|-------+   |   
     |   |         | | | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |     |     | |           |     |     |   | | |       |     |   | | | | |   | |   | |   | | | | |     |   
     |   |         | +-|---|---------|---|-------------------|-|-|---|-|---|-|-----------------|-----------|-|-----------|-----|-----|---------------------|-----------|---------|-----|---|---------|-+ 
     |   |         |   | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |     |     | |           |     |     |   | | |       |     |   | | | | |   | |   | |   | | | | |     | | 
     |   |         +---|---------|---|---|-----------|-----------------|---|---|------L----|-|-------+     | |           |     |     |   | | |       |     |   | +-|-|-|---|-|---|-----|-|---+ | +---+ | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |     |     |   | | |       |     |   |   | | |   | |   | |   | | |   | |     | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |     |     |   | | | +---------------------|-|-----|-----------|-------|---+ | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | | |           | |           |     |     |   | | | |     |     |   |   | | |   | |   | |   | | |   | |   | | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | | +-|-----------|-|---+       | +-------------|-----------------|---|-----|-|---|-|-----|---|-|---+ | |   | | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | |   |           | |   |       | |   |     |   | | | |     |     |   |   | | |   | |   | |   | | | | | |   | | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | |   +-------------|---|-------|-----|---------|---|-|-----|-----------+ | | | +-|-------|-------|-----|---+ | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | |               | |   |       | |   |     |   | | | |     |     |   | | | | | | | |   | |   | | | | | |     | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | |               | |   |       | |   |   +-------|-|-------------|---|-+ | | | | | |   | |   | | | | | |     | 
     |   |             | | | |   | | |   |     |     |     | | | |   | |   | | |     |   | |               | |   |       | |   |   | |   | | | |     |     |   |   | | | X | |   | |   | | | | | |     | 
     |   |             | | | +---|-------|-----------------|---|-|-------------------|---------+           +-----|-------------|-----|-----|-----------------------|-|-------|---|-|---|-|-|-|-------+ | 
     |   |             | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |             |   |       | |   |   | |   | | | |     |     |   |   | | | | | |   | |   | | | | | |   | | 
   +--B--|---------+   | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |           +-|-----------|---+ |   | |   | | | |     |     |   | +-|---|---------+ |   | | | | | |   | | 
   | |   |         |   | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |           | |   |       | | | |   | |   | | | |     |     |   | | | | | | | |     |   | | | | | |   | | 
   | |   |         +---|-|-----------|---------|-------------|-------|-----|-|-|-----|---|-----------------------|-------|-|-------|-|-----|---|-----|-----|---|-----|-----|-|-----|---+ | +-|-|-|---+ | 
   | |   |             | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |           | |   |       | | | |   | |   | | | |     |     |   | | | | | | | |     |     |   | | |     | 
   | |   |             | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |           +-----------------------|-------|-|-|---------------|-------|-|-------+ |     |   | | | +-+ | 
   | |   |             | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |             |   |       | | | |   | |   | | | |     |     |   | | | | | | | |   | |     |   | | | | | | 
   | |   |             | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |             |   |       | | | |   | |   | | | |     |     |   | | | | | | | |   | |     |   | | | | | | 
   | |   |             | | |     | | |   |     |     |     | | | |   | |   | | |     |   | |   |             |   |       | | | |   | |   | | | |     |     |   | | | | | | | |   | |     |   | | | | | | 
   | |   |             | | |     | | |   |     |     |     | | | |   +-----|-|-----------|-|---|-------------|---|-------|-----|---|-|---|-----|---------------|-----|-|-|-------|-|-------+ | | | | | | 
   | |   |             | | |     | | |   |     |     |     | | | |     |   | | |     |   | |   |             |   |       | | | |   | |   | | | |     |     |   | | | | | | | |   | |     | | | | | | | | 
   | |   +-------------|-|-|---------|---+     |     |     | | | |     |   | | |     |   | | +-|-----------------|-------+ | | |   | |   | | | |     |     |   | | +---|---------|-----+ | | | | | | | | 
   | |                 | | |     | | |         |     |     | | | |     |   | | |     |   | | | |             |   |         | | |   | |   | | | |     |     |   | |   | | | | |   | |   | | | | | | | | | 
   | |             +---|-|-|---------|---------------------|---|-------|-----|-|-----|---+ +---|-------------|---|-------------------------|-|-|-----------|---|---------|-|-|---|-|---|---+ | | | | | | 
   | |             |   | | |     | | |         |     |     | | | |     |   | | |     |       | |             |   |         | | |   | |   | | | |     |     |   | |   | | | | |   | |   | |   | | | | | | 
   | |             |   | | |     | | |         |     |     | | | |     |   | | |     |       | |         +---|---------------------------------------|---------|-|---|-|---|-----|-----------|-|-----+ | 
   | |             |   | | |     | | |         |     |     | | | |     |   | | |     |       | |         |   |   |         | | |   | |   | | | |     |     |   | |   | | | | |   | |   | |   | | | |   | 
   | |             |   +-|-|-----|-|-----------|-------------|-|-|---------|---|-----|-------|-----------|---|-------------+ | |   | |   | | | |     |     |   | +-----|-|---+   | | +-|-|-+ | | | |   | 
   | |             |     | |     | | |         |     |     | | | |     |   | | |     |       | |         |   |   |           | |   | |   | | | |     |     |   |     | | | |     | | | | | | | | | |   | 
   | |             |     | |     | | |         |     |     | | | |     |   | | |     |       | |         |   |   |           | |   | |   | | | |     |     |   |     | | | |     | | | | | | | | | |   | 
   | |             |     | |     | | |         |     |     | | | |     |   | | |     |       | |         |   |   |           | |   | |   | | | |     |     |   |     | | | |     | | | | | | | | | |   | 
   | |           +-------|-|-------|-------------------------|---------|---|---------------------------------|---------------------|-|---|-|---|-----|-----|-------------|-|-----|-|-|---|---+ | | |   | 
   | |           | |     | |     | | |         |     |     | | | |     |   | | |     |       | |         |   |   |           | |   | |   | | | |     |     |   |     | | | |     | | | | | |   | | |   | 
   | |           | |     | |     | | |         |     |     | | | |     |   | | |   +---------------------|---|-----------------|---------|-|---|---------------|---------|-------|---|---|-----------+ | 
   | |           P |     | |     | | |         |     |     | | | |     |   | | |   | |       | |         |   |   |           | |   | |   | | | |     |     |   |     | | | |     | | | | | |   | | | | | 
   | |           | |     | |     | | | +-------------|-----|---|-|-----+   | | |   | |       | |         |   |   |           | |   | |   | | | |     |     |   |     | | | +-----|-|-|-|---|---|---+ | | 
   | |           | |     | |     | | | |       |     |     | | | |         | | |   | |       | |         |   |   |           | |   | |   | | | |     |     |   |     | | |       | | | | | |   | |   | | 
   | |           | |     | |     | | | | +-----|-----|-------|---|-----------------|-------------------------|---------------|-|---|-------|---|-----|---------|-+   | | | +-----|-|-|---|---------+ | | 
   | |           | |     | |     | | | | |     |     |     | | | |         | | |   | |       | |         |   |   |           | |   | |   | | | |     |     |   | |   | | | |     | | | | | |   | | | | | 
   | |           | |     | |     | | | | |     |     |     | | | |         | | |   | |       | |         |   |   |           | |   | |   | | | |     |     |   | |   | | | |     | | +-|-|-----|---+ | | 
   | |           | |     | |     | | | | |     |     |     | | | |         | | |   | |       | |         |   |   |           | |   | |   | | | |     |     |   | |   | | | |     | |   | | |   | |   | | 
   | |           | |     | +---------|---+     | +---|-----|---|-|-------------|-----|-------|-|---------|---+   |       +-----|-----|-----|-|-|-------------+ | +---------|-------|---|-|-|-----|-+ | | 
   | |           | |     |       | | | |       | |   |     | | | |         | | |   | |       | |         |       |       |   | |   | |   | | | |     |     | | |     | | | |     | |   | | |   | | | | | 
   | |           | |     |       | | | |       +-+   |     | | | | +---------|-----|-|-------|-|-----+   |       |       |   | |   | |   | | | |     |     | | |     | | | |     | |   | | |   | | | | | 
   | |           | |     |       | | | |             |     | | | | |       | | |   | |       | |     |   |       |       |   | |   | |   | | | |     |     | | |     | | | |     | |   | | |   | | | | | 
   | |           | |     |       | | | |             |     | | | | |       | | |   | |       | |     +-----------|-----------|-----|-----|---|-|-----|---------|-----|-|-|-------|-|-+ | | |   | | | | | 
   | |           | |     |       | | | |             |     | | | | |       | | |   | |       | |         |       |       |   | |   | |   | | | |     |     | | |     | | | |     | | | | | |   | | | | | 
   | |           | |     |       | | | |             |     | | | | |       | | |   | |       | |         | +-------------------|-----|---|-|-|-------------|-----------|---|-----|---+ | | |   | | | | | 
   | |           | |     |       | | | |             |     | | | | |       | | |   | |       | |         | |     |       |   | |   | |   | | | |     |     | | |     | | | |     | |   | | |   | | | | | 
   +-|-------------------|---------|-|---------------|-----|-|-----|-------|-|-|-----+       | |         | |     |       |   | |   | |   | | | |     |     | | |     | | | |     | |   | | |   | | | | | 
     |           | |     |       | | | |             |     | | | | |       | | |   |         | |         | |     |       |   | |   | |   | | | |     |     | | |     | | | |     | |   | | |   | | | | | 
     |           | |     |       | | | |             |     | | | | |       | | |   |     +-----|------H------+   |       |   | |   | |   | | | |   +-|-----|---|-+   | | | +-+   | |   | | |   | | | | | 
     |           | |     |       | | | |             |     | | | | |       | | |   |     |   | |         | | |   |       |   | |   | |   | | | |   | |     | | | |   | | |   |   | |   | | |   | | | | | 
     |           | |     |       | | | |             |     | | | | |       | | |   |     |   | |         | | |   |       |   | |   | |   | | | |   | |     +-----|---|---------+ | |   +-|-+   | | | | | 
     |           | |     |       | | | |             |     | | | | |       | | |   |     |   | |         | | |   |       |   | |   | |   | | | |   | |       | | |   | | |   | | | |     |     | | | | | 
     |       +-----|-----|---------+ | |             |     | | | | |       | | |   |     |   | |         | | |   | +---------------|-----|-|---|-------------|---|-----|-|-----|-----------------+ | | | 
     |       |   | |     |       |   | |             |     | | | | |       | | |   |     |   | |         | | |   | |     |   | |   | |   | | | |   | |       | | |   | | |   | | | |     |     |   | | | 
     |       |   | |     |       |   | |             |     | | | | |       | | |   |     |   | |         | | |   | |     |   | |   | |   | | | |   | |       | | |   | | |   | | | |     |     |   | | | 
     |       |   | |     |       |   | V             |     | | | | |       | | |   |     |   | |         | | |   | |     |   | |   | |   | | | |   | |       | | |   | | |   | | | |     |     |   | | | 
   +-|-------------|-------+     |   | |             |     | | | | |       | | |   |     |   | |         | | |   | +---------------|-------|-+ |   | |       | | |   | | |   | | | |     |     |   | | | 
   | |       |   | |     | |     |   | |             |     | | | | |       | | |   |     |   | |         | | |   |       |   | |   | |   | |   |   | |       | | |   | | |   | | | |     |     |   | | | 
   | |       |   | |     | |     |   | |             |     | | | | |       | | |   |     | +-------------+ | |   |       |   | |   | |   | |   |   | |       | | |   | | |   | | | |     |     |   | | | 
   | |       |   | |     | |     |   | |             |     | | | | |       | | |   |     | | | |           | |   |       |   | |   | |   | |   |   | |       | | |   | | |   | | | |     |     |   | | | 
 +-+ |       |   | |     | |     |   | +-------------|-------|---|-------+ | | |   |   +---|-|-|-----------|-|-------+   |   | |   | |   | |   |   | |       | | |   | | |   | | | |     |     |   | | | 
 |   |       |   | |     | |     |   |               |     | | | | |     | | | |   |   | | | | |           | |   |   |   |   | |   | |   | |   |   | |       | | |   | | |   | | | |     |     |   | | | 
 |   |     +-----|-|-------------|---|---------------|-------|---|-------|---|-----|---|---------------------|---|---|-------------------|-----|---|-|-------|-------|-------|-+ | |     |     |   | | | 
 |   |     | |   | |     | |     |   |               |     | | | | |     | | | |   |   | | | | |           | |   |   |   |   | |   | |   | |   |   | |       | | |   | | |   |   | |     |     |   | | | 
 |   |     | |   | |     | | +---|-------------------|---------+ | |     | | | |   |   +---+ | |         +-|-+   |   |   |   | |   | |   | |   |   | |   +---|---------|-|-----+ | |   +---------+ | | | 
 |   |     | |   | |     | | |   |   |               |     | |   | |     | | | |   |     |   | |         | |     |   |   |   | |   | |   | |   |   | |   |   | | |   | | |   | | | |   | |     | | | | | 
 |   |     | |   | | +-------|-------------------+   +---------+ | | +-----|---|---|-+   |   | |         | |     |   |   |   | | +---------|---|---------|---|-+ |   | | |   | | | +-+ | |     | | | | | 
 |   |     | |   | | |   | | |   |   |           |         | | | | | |   | | | |   | |   |   | |         | |     |   |   |   | | | | |   | |   |   | |   |   |   |   | | |   | | |   | | |     | | | | | 
 |   |     | |   | +-|-------|---|---+           +---------|-------------|-|-|-|-----|---|---|-|---------+ +-----|-----------------------------------|-----------|---|---|---|-|-------|-+     | | | | | 
 |   |     | |   |   |   | | |   |                         | | | | | |   | | | |   | |   |   | |                 |   |   |   | | | | |   | |   |   | |   |   T   |   | | |   | | |   | |       | | | | | 
 +---|-----|-|-------|-------|---------------------------------|---|---------|-|-----|---|-----------------------|---------------|-|-----|---+ |   | |   |   |   |   | | |   | | +-+ | |   +-+ | | | | | 
     |     | |   |   |   | | |   |                         | | | | | |   | | | |   | |   |   | |                 |   |   |   | | | | |   | | | |   | |   |   |   |   | | |   | |   | | |   | | | | | | | 
     |     | |   |   |   | | |   |                         +-----|-|-|-----|---|---------|---|-----------------------|-------|-|-----------|-|-|----------E------|-------|---|---+ | | |   | | | | | | | 
     |     | |   |   |   | | |   |                           | | | | |   | | | |   | |   |   | |                 |   |   |   | | | | |   | | | |   | |   |   |   |   | | |   | | | | | |   | | | | | | | 
     |     | +-------|-----------|---------------------------|-|-|---|---|-----------|---|-----+                 |   |   |   | | | | |   | | | |   | +---|-----------|---------|---+ | |   | | | | | | | 
     |     |     |   |   | | |   |                           | | | | |   | | | |   | |   |   |                   |   |   |   | | | | |   | | | |   |     |   |   |   | | |   | | |   | |   | | | | | | | 
     |     |     |   |   +-|-|-------------------------------|-|-|-------|-|---|---------|---------------+       |   +---------------|---|---------|---------------------|---+ | |   | | +-+ | | | | | | 
     |     |     |   |     | |   |                           | | | | |   | | | |   | |   |   |           |       |       |   | | | | |   | | | |   |     |   |   |   | | |     | |   | | |   | | | | | | 
     |     |     |   |     | | +---------------------------------|-|-|---|---|-|---|-|-------|-----------|-------|-----------|---|-------------|---|-----|---|---|-----|-|-------|---+ | +-+ | | | | | | 
     |     |     |   |     | | | |                           | | | | |   | | | |   | |   |   |           |       |       |   | | | | |   | | | |   |     |   |   |   | | |     | |     |   | | | | | | | 
     +-----+ +-----+ |     | | | |                           | | | | |   | | | |   | |   |   |       +---|-+     |       |   | | | | +-----|-------|---------|-----------|-----+ |     +---|-+ | | | | | 
             |   | | |     | | | |                           | | | | |   | | | |   | |   |   |       |   | |     |       |   | | | |     | | | |   |     |   |   |   | | |       |         |   | | | | | 
 +---------------------------|---+                           | | | | |   | | | |   | +-------|-------|-----------|-------|---|-----------|-|---------------------|-----|-|---+   | +-------|-+ | | | | | 
 |           |   | | |     | | |                             | | | | |   | | | |   |     |   |       |   | |     |       |   | | | |     | | | |   |     |   |   |   | | |   |   | |       | | | | | | | 
 |           |   | | |     | | |                             | | | | |   | | | |   | +---|-----------|---|-|-----|-------|---|-|-----+   | | +-|---------|---|---------|-|---|-+ | |       +-+ | | | | | 
 |           |   | | |     | | |                             | | | | |   | | | |   | |   |   |       |   | |     |       |   | | | | |   | |   |   |     |   |   |   | | |   | | | |           | | | | | 
 +-----------|-----|-------|---|---------------------------------|-------|---|-------|---------------|-----------|---+   |   | | | | |   | |   |   +-----|-+ |   |   | | |   | | | |           | | | | | 
             |   | | |     | | |                             | | | | |   | | | |   | |   |   |       |   | |     |   |   |   | | | | |   | |   |         | | |   |   | | |   | | | |           | | | | | 
 +---------------|-|-|---------|-----------------------------|-----|-|-------|-|---|-|---|---|-------|---------------|-------|---|-|-|---------|---+     | | |   |   | | |   | | | |           | | | | | 
 |           |   | | |     | | |                             | | | | |   | | | |   | |   |   |       |   | |     |   |   |   | | | | |   | |   |   |     | | |   |   | | |   | | | |           | | | | | 
 |           |   | | |   +-|---|-+ +-------------------------------+ |   | | | |   +-----|---|-------|---------------|-------|-------|---+ |   |   | +-----|-|---|-----------|-|---------------|---+ | | 
 |           |   | | |   | | | | | |                         | | |   |   | | | |     |   |   |       |   | |     |   |   |   | | | | |     |   |   | |   | | |   |   | | |   | | | |           | |   | | 
 +-----------|-----|-|---|-|---|-|---+                       | | |   |   | | | |     |   |   |       |   | |     +---|---|---|-|-|-+ |     |   |   | | +---|---------|-|-----|-|---|---+ +-----|---+ | | 
             |   | | |   | | | | | | |                       | | |   |   | | | |     |   |   |       |   | |         |   |   | | |   |     |   |   | | | | | |   |   | | |   | | | |   | |     | | | | | 
             |   | | |   | | | | | | |       +---------------|---|-------|---|-|-----|---|-----------|---|-|---------|-------|-|-|---+     |   |   +---+ | | |   | +-+ | +---|-------------+   | | | | | 
             |   | | |   | | | | | | |       |               | | |   |   | | | |     |   |   |       |   | |         |   |   | | |         |   |     |   | | |   | |   |     | | | |   | | |   | | | | | 
             |   | | |   | | | | | | |       |               | | |   |   | | | |     |   |   |       |   | +-------+ +-------|-----------------------------|---+ +-|-----------|-------+ | |   | | | | | 
             |   | | |   | | | | | | |       |               | | |   |   | | | |     |   |   |       |   |         |     |   | | |         |   |     |   | | | |   |   |     | | | |     | |   | | | | | 
 +---+       |   | +-----|---------|---------|---------------|-------|-----|-+ |     |   |   |       |   +---------|-----|-------|-------------|---------|-|-----------|-----|---+ |   +-|-+   | | | | | 
 |   |       |   |   |   | | | | | | |       |               | | |   |   | |   |     |   |   |       |             |     |   | | |         |   |     |   | | | |   |   |     | |   |   | |     | | | | | 
 +---|-----+ |   |   |   | | | | | | |       |               | | |   |   +-|---|-----|---|-----------|-------+     +-----|---|-----------------|-----|-------|-|---------------|-------|---+   | | | | | 
     |     | |   |   |   | | | | | | |       |               | | |   |     |   |     |   |   |       |       |           |   | | |         |   |     |   | | | |   |   |     | |   |   | | |   | | | | | 
     |     | |   |   +---|---|-|-----|---+   |               | | |   |     +---------|---|-------------------------------------|-|-------------------------|-|---+ |   |     | | +-------|-|-------+ | | 
     |     | |   |       | | | | | | |   |   |               | | |   |         |     |   |   |       |       |           |   | | |         |   |     |   | | | | | |   |     | | | |   | | |   | |   | | 
     |     | |   |       | | | | | | |   |   |               | | |   |         |   +---------|---------------|-----------|---|-------------|---------------|-----|-----------|---------+ | +-+ | |   | | 
     |     | |   |       | | | | | | |   |   |               | | |   |         |   | |   |   |       |       |           |   | | |         |   |     |   | | | | | |   |     | | | |     |   | | |   | | 
     +-----|-----|---------+ | | | | +---+   |               | | +-----------------------|-----------------+ |           |   | | |         |   |     |   | | | | | +---------|---+ +-----|-+ | | |   | | 
           | |   |       |   | | | |         |               | |     |         |   | |   |   |       |     | |           |   | | |         |   |     |   | | | | |     |     | |         | | | | |   | | 
           | +---|-------|---|-+ | | +-------|---------------|-----------------------|---|---|-------------|-|-----------+   | | |         | +-------|---|-|-+ | | +---|-----|-----------|---|---+   | | 
           |     |       |   |   | | |       |               | |     |         |   | |   |   |       |     | |               | | |         | | |     |   | |   | | |   |     | |         | | | |     | | 
           |     |       |   |   | | |       |               | |     |         |   | |   |   |     +-|-----------------------+ | +-----------|---------------+ | | | +-|-----|-|-------+ | | | |     | | 
           |     |       |   |   | | |       |               | |     |         |   | |   |   |     | |     | |                 |           | | |     |   | | | | | | | |     | |       | | | | |     | | 
           +-----|-----------|-------|-------|---------------|-------|-------------+ |   +---+     +-|-----|-------------------|-------------|-|-----|---+ +-+ | | | | |     | | +---+ +-+ | | +---+ | | 
                 |       |   |   | | |       |               | |     |         |     |               |     | |                 |           | | |     |         | | | | |     | | |   |     | |     | | | 
                 |       |   +---+ | |       |               | |     |         |     +---------------|-----|-----------------------------------------|---------+ | | | +-------|-----------+ |     | | | 
                 |       |         | |       |               | |     |         |                     |     | |                 |           | | |     |           | | |       | | |   |       |     | | | 
                 |       +-----------|-------|---------------|-|-----|-------------------------------------|-------------------|-----------+ | +-----+ +-----------------------+ |   |       |     | | | 
                 |                 | |       |               | |     |         |                     |     | |                 |             |         |         | | |       |   |   |       |     | | | 
                 |                 +---------------------------|-----|-------------------------------|-------|-----------------|-------------+         +-------------|-------------+ +-------|---+ | | | 
                 |                   |       |               | |     |         |                     |     | |                 |                                 | | |       |   | |         |   | | | | 
                 +-------------------|-----------------------|-|-----|---------------------------------------------+ +---------|---------------------------+     | | |       +---|-+         |   | | | | 
                                     |       |               | |     |         |                     |     | |     | |         |                           |     | | |           |           |   | | | | 
                                     +-------+               +-+     +---------+                     +-------------+ +---------|---------------------------|-----|---------------|-----------+   +---|-+ 
                                                                                                           | |                 |                           |     | | |           |                 | |   
                                                                     +-------------------------------------+ +-----------------+                           +-----|-------------------------------+ | |   
                                                                     |                                                                                           | | |           |               | | |   
                                                                     +-------------------------------------------------------------------------------------------+ +-+           +---------------+ +-+   `;

		class NetworkDiagram {
			constructor(networkDiagramData) {
				this.left = {x:-1,y:0};
				this.right = {x:1,y:0};
				this.up = {x:0,y:-1};
				this.down = {x:0,y:1};

				this.networkDiagramData = networkDiagramData;
				this.extractNetworkDiagram();
				this.currentPosition = {x:0,y:0};
				
				this.currentPosition = this.findStart();
				this.currentDirection = this.down;
				this.letters = '';
				this.stepsCount = 0;
			}

			extractNetworkDiagram() {
				this.networkDiagram = this.networkDiagramData
					.split('\n')
					.map(row => [...row]);
				this.maxY = this.networkDiagram.length-1;
				this.maxX = this.networkDiagram[0].length-1;
			}
			
			findStart(){
				let firstRow = this.networkDiagram[0];
				let x = firstRow.indexOf('|');
				return {x,y:0}
			}
			findEnd(){
				let nextValue;
				do{
					nextValue = this.nextMove();
					if(nextValue == '|'){
						continue;
					}else if(nextValue == '-'){
						continue;
					}else if(nextValue == '+'){
						this.changeDirection();
					}else{
						this.letters += nextValue;
					}
				}while(nextValue != ' ')
			}
			nextMove(){
				this.stepsCount++;
				let {x,y} = this.currentPosition;
				x += this.currentDirection.x;
				y += this.currentDirection.y;
				this.currentPosition = {x,y};
				return this.getValue(this.currentPosition);
			}

			changeDirection(){
				if(this.currentDirection == this.left){
					if(this.getUp()) this.currentDirection = this.up;
					else if(this.getDown()) this.currentDirection = this.down;
					else if(this.getLeft()) this.currentDirection = this.left;
				}else if (this.currentDirection == this.right) {
					if (this.getUp()) this.currentDirection = this.up;
					else if (this.getDown()) this.currentDirection = this.down;
					else if (this.getRight()) this.currentDirection = this.right;
				}else if (this.currentDirection == this.up) {
					if (this.getUp()) this.currentDirection = this.up;
					else if (this.getLeft()) this.currentDirection = this.left;
					else if (this.getRight()) this.currentDirection = this.right;
				}else if (this.currentDirection == this.down) {
					if (this.getDown()) this.currentDirection = this.down;
					else if (this.getLeft()) this.currentDirection = this.left;
					else if (this.getRight()) this.currentDirection = this.right;
				}
			}
			getRight(){
				let newPosition = this.getNewPosition(this.currentPosition, this.right);
				if(newPosition.x > this.maxX) return false;
				return this.checkDirection(newPosition);
			}
			getLeft(){
				let newPosition = this.getNewPosition(this.currentPosition, this.left);
				if(newPosition.x < 0) return false;
				return this.checkDirection(newPosition);
			}
			getUp(){
				let newPosition = this.getNewPosition(this.currentPosition, this.up);
				if(newPosition.y < 0) return false;
				return this.checkDirection(newPosition);
			}
			getDown(){
				let newPosition = this.getNewPosition(this.currentPosition, this.down);
				if(newPosition.y > this.maxY) return false;
				return this.checkDirection(newPosition);
			}
			checkDirection(position){
				let value = this.getValue(position);
				return /[\|-\w]/.test(value);
			}
			getValue(position){
				let { x, y } = position;
				return this.networkDiagram[y][x];
			}
			getNewPosition(position, direction){
				let {x,y} = position;
				x+=direction.x;
				y+=direction.y;
				return {x,y};
			}

			partA() {
				this.findEnd();
				console.log(this.letters);
			}
			partB(){
				console.log(this.stepsCount);
			}

		}


		let networkDiagramTest = new NetworkDiagram(day19inputTest);
		networkDiagramTest.partA();
		networkDiagramTest.partB();
		let networkDiagram = new NetworkDiagram(day19input);
		networkDiagram.partA();
		networkDiagram.partB();



	</script>
</body>

</html>